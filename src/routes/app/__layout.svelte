<script context="module">
	/** @type {import('./__types/[slug]').Load} */
	export async function load({ fetch }) {
		const res = await fetch('/api/questions');

		return {
			status: res.status,
			props: {
				data: res.ok && (await res.json())
			}
		};
	}
</script>

<script>
	import '$lib/global.css';
	import { onMount } from "svelte";
	import FakeSiteNav from '/src/components/fakeSiteNav.svelte';
	import Questions from '/src/components/questions.svelte';

	onMount(async () => {
		let xterm = (await import('$lib/js/terminal.js'));
		xterm.default();
	});

	export let data;
	let questions = data.questionsFiltered;
	let answers = [];
</script>

<div class="grid grid-cols-12 h-screen">
	<!-- Questions Section -->
	<Questions {questions} {answers} />

	<!-- Main Section -->
	<div class="col-start-4 col-end-13 relative">
		<div class="navbar custom-navbar">
			<div class="nav-cover">
				<!-- Logout -->
				<button class="btn btn-sm custom-navbar-button logout">
					Logout
				</button>
			</div>
			<div class="logo invisible md:visible"></div>
			<div class="logo sm visible md:invisible"></div>
		</div>
		
		<!-- Terminal -->
		<div class="collapse absolute top-1 left-1">
			<input type="checkbox" class="min-h-0" />
			<div class="collapse-title min-h-0">
				<button class="btn btn-sm custom-navbar-button pl-2">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mt-0dot75" viewBox="0 0 20 20" fill="currentColor">
						<path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd" />
					</svg> Terminal&nbsp;<span class="font-normal pointer-events-none">(</span><small class="relative mt-0.5 font-normal pointer-events-none">Show/Hide</small><span class="font-normal pointer-events-none">)</span></button>
			</div>
			<div class="collapse-content">
				<div class="card card-compact shadow text-primary-content terminal-wrapper">
					<div id="terminal"></div>
				</div>
			</div>
		</div>
		
		<!-- Content for main -->
		<div class="fake-site-outer-wrapper fake-site-font">
			<div class="fake-site-inner-wrapper">
				
				<FakeSiteNav />

				<div class="p-2">
					<slot />
				</div>				
			</div>
		</div>
		
	</div>
</div>