<script context="module">
	/** @type {import('./__types/[slug]').Load} */
	export async function load({ fetch }) {
		const res = await fetch('/api/questions');

		return {
			status: res.status,
			props: {
				data: res.ok && (await res.json())
			}
		};
	}
</script>

<script>
	import '$lib/global.css';
	import { onMount } from "svelte";
	import Questions from '/src/components/questions.svelte';
	import FakeSiteNav from '/src/components/fakeSiteNav.svelte';

	onMount(async () => {
		let xterm = (await import('$lib/js/terminal.js'));
		xterm.default();
	});

	export let data;
	let questions = data.questionsFiltered;
	let answers = [];
</script>

<div class="grid grid-cols-12 h-screen">
	<!-- Questions Section -->
	<Questions {questions} {answers} />

	<!-- Main Section -->
	<div class="col-start-4 col-end-13 relative">
		<div class="navbar custom-navbar">
			<div class="nav-cover">
				<!-- Logout -->
				<button class="btn btn-sm custom-navbar-button logout">
					Logout
				</button>
			</div>
			<div class="logo invisible md:visible"></div>
			<div class="logo sm visible md:invisible"></div>
		</div>
		
		<!-- Terminal -->
		<div class="collapse absolute top-1 left-1">
			<input type="checkbox" class="min-h-0" />
			<div class="collapse-title min-h-0">
				<button class="btn btn-sm custom-navbar-button">Terminal&nbsp;<span class="font-normal pointer-events-none">(</span><small class="relative mt-0.5 font-normal pointer-events-none">Show/Hide</small><span class="font-normal pointer-events-none">)</span></button>
			</div>
			<div class="collapse-content">
				<div class="card card-compact shadow text-primary-content terminal-wrapper">
					<div id="terminal"></div>
				</div>
			</div>
		</div>
		
		<!-- Content for main -->
		<div class="fake-site-outer-wrapper">
			<div class="fake-site-inner-wrapper">
				<FakeSiteNav />
				
				<div class="p-2">
					<slot />
				</div>
			</div>
		</div>
		
	</div>
</div>