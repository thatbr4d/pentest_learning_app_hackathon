<script>
    import { goto } from "$app/navigation";
    import Input from "/src/components/Input.svelte";

    let username;
    let password;
    let error;

    async function submit(){
        const res = await fetch('/api/admin/sign-in', {
            method: 'POST',
            body: JSON.stringify({username, password}),
            headers:{
                'Content-Type': 'application/json'
            }
        });

        if (!res.ok) {
            error = (await res.json()).message;
            return;
        }else{
            goto('/app/admin');
        }
    }
</script>

<form on:submit|preventDefault={submit} class='space-y-5 max-w-xl mx-auto mt-8'>
    <Input label='Username' id='username' name='username' bind:value={username} required />
    <Input label='Password' id='password' name='password' type='password' bind:value={password} required />
    <button type='submit' class="btn">Sign In</button>
</form>

{#if error}
  <p class='mt-3 text-red-500 text-center font-semibold'>{error}</p>
{/if}